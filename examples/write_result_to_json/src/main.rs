use fofa;
use tokio;

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    let client = fofa::FofaClient {
        key : "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".to_string(),    //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        fields : "host,ip,port,domain,server,os".to_string(),
        query_string: "domain=apple.com".to_string(),
        size: 10,
    };
    // let raw_response = client.search(1).await.unwrap();
    // let response = client.get_result(raw_response);              //Vec<Vec<String>>，只输出一页的情况
    let response = client.get_selected_pages(2,10).await.unwrap();  //Vec<Vec<String>>，也可以拿去使用client.get_lines切片，或者write_data_to_*写入
    let location = "./".to_string();
    client.write_data_to_json(location, response);              
    Ok(())
}
/* Output:
    文件会输出在指定目录下，目录必须之前就存在
    Samples:
    [
  [
    "https://fsi-platform-partner.apple.com",
    "17.33.192.58",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "rsa-fsi-rno.apple.com",
    "17.179.240.221",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://use1-fsi-platform-partner.apple.com",
    "17.33.201.133",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "rsa-fsi-prz.apple.com",
    "17.137.160.165",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "fsi-platform-partner.apple.com",
    "17.33.194.222",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "use1-fsi-platform-partner.apple.com",
    "17.33.202.88",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "rsa-fsi-partner.apple.com",
    "17.137.160.165",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://usw2-fsi-platform-partner.apple.com",
    "17.33.194.222",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "rsa-fsi-bnp-partner.apple.com",
    "17.137.160.165",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "usw2-fsi-platform-partner.apple.com",
    "17.33.194.222",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://okapi-services-euw1.apple.com",
    "17.188.22.142",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://okapi-services-use1.apple.com",
    "17.188.22.76",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://okapi-services-usw2.apple.com",
    "17.188.22.42",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "okapi-services-euw1.apple.com",
    "17.188.22.157",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://okapi-services-apse1.apple.com",
    "17.188.22.220",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "okapi-services-use1.apple.com",
    "17.188.22.91",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "okapi-services-usw2.apple.com",
    "17.188.22.22",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "okapi-services-apse1.apple.com",
    "17.188.22.205",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "okapi-services.apple.com",
    "17.8.131.136",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://okapi-services.apple.com",
    "17.8.131.8",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://okapi-services.apple.com",
    "17.8.131.8",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://mwp15-st14-ssl.ls.apple.com",
    "17.167.200.82",
    "443",
    "apple.com",
    "",
    ""
  ],
  [
    "images.apple.com",
    "106.4.158.58",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://mwp9-st14-ssl.ls.apple.com",
    "17.167.200.84",
    "443",
    "apple.com",
    "",
    ""
  ],
  [
    "https://apay-partner-api-lt-bz.apple.com",
    "17.32.208.79",
    "443",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "apay-partner-api-lt-bz.apple.com",
    "17.32.208.79",
    "80",
    "apple.com",
    "Apple",
    ""
  ],
  [
    "https://entitlements.podcasts.apple.com",
    "17.8.152.105",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements.books.apple.com",
    "17.8.152.135",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements.music.apple.com",
    "17.8.152.105",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements.apps.apple.com",
    "17.8.152.135",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements.podcastsconnect.apple.com",
    "17.8.152.174",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements.podcastsconnect.apple.com",
    "17.8.152.105",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements.podcasts.apple.com",
    "17.8.152.135",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements.music.apple.com",
    "17.8.152.135",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements.apps.apple.com",
    "17.8.152.174",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements.books.apple.com",
    "17.8.152.105",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements.tv.apple.com",
    "17.8.152.174",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements.tv.apple.com",
    "17.8.152.174",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "musicstatus.tv.apple.com",
    "17.8.155.208",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "musicstatus.apps.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "musicstatus.podcastsconnect.apple.com",
    "17.8.155.208",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://musicstatus.podcastsconnect.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "musicstatus.podcasts.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://buylite.podcasts.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "musicstatus.music.apple.com",
    "17.8.155.208",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements-edge.apps.apple.com",
    "17.8.155.208",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements-edge.podcastsconnect.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements-edge.music.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements-edge.podcastsconnect.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements-edge.tv.apple.com",
    "17.8.155.208",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://musicstatus.tv.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "buylite.apps.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://musicstatus.books.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://speedysub.books.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "speedysub.podcasts.apple.com",
    "17.8.155.208",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://speedysub.link.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://buylite.tv.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements-edge.podcasts.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://speedysub.apps.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "musicstatus.books.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://speedysub.tv.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements-edge.tv.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://buylite.apps.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "buylite.podcasts.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "buylite.tv.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://buylite.music.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://musicstatus.apps.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "speedysub.music.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://buylite.link.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "speedysub.link.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://musicstatus.podcasts.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "buylite.music.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://buylite.books.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "buylite.link.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://musicstatus.music.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements-edge.apps.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://speedysub.podcastsconnect.apple.com",
    "17.8.155.249",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://buylite.podcastsconnect.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://speedysub.podcasts.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "buylite.podcastsconnect.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "speedysub.podcastsconnect.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "speedysub.tv.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements-edge.books.apple.com",
    "17.8.156.30",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "buylite.books.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "speedysub.books.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://speedysub.music.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "speedysub.apps.apple.com",
    "17.8.155.249",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements-edge.music.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "entitlements-edge.books.apple.com",
    "17.8.156.30",
    "80",
    "apple.com",
    "daiquiri/5",
    ""
  ],
  [
    "https://entitlements-edge.podcasts.apple.com",
    "17.8.155.208",
    "443",
    "apple.com",
    "daiquiri/5",
    ""
  ]
]
*/